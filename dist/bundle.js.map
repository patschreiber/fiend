{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/engine/FiendGame.ts","src/engine/Renderer/Renderer.ts","src/entities/Enemy.ts","src/main.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import { Enemy } from \"../entities/Enemy\";\n\n/**\n * The Game superclass. Operations to act upon the main game thread are found\n * here.\n */\nexport class FiendGame {\n\n  public canvas: HTMLCanvasElement;\n  public gameObjectCount: number;\n  public gameObjects: Array<Enemy>;\n\n  public ctx: CanvasRenderingContext2D;\n  \n  protected container: HTMLElement;\n  stopToken: number|null;\n  tickLength: number;\n  lastFrameTime: number;\n  maxEntities: number;\n\n  constructor(gamePaneWidth: number, gamePaneHeight: number) {\n\n    /**\n     * \n     */\n    this.canvas = this.genCanvas(gamePaneWidth, gamePaneHeight);\n    this.container = document.getElementById(\"fiend-game\");\n    this.container.insertBefore(this.canvas, this.container.firstChild);\n    this.ctx = this.canvas.getContext('2d');\n\n    /**t\n     * Prevent anti-aliasing in the event a tile gets scaled.\n     * \n     * @property {CanvasRenderingContext2D.imageSmoothingEnabled}\n     */\n    this.ctx.imageSmoothingEnabled = false;\n\n    /**\n     * The ID returned from our main loop's most recent call to\n     * requestAnimationFrame(). The token can then be used when we call\n     * cancelAnimationFrame() to stop the main loop by telling the browser to\n     * cancel the request that corresponds to our token.\n     * @type {number}\n     */\n    this.stopToken = null;\n\n    /**\n     * How frequently the game state updates. It is 16.66 Hz (60ms)\n     * @type {number}\n     */\n    this.tickLength = 60;\n\n    /**\n     * The most recently elapsed tick of the game clock.\n     * @type {double} DOMHighResTimeStamp\n     */\n    this.lastFrameTime = 0;\n\n    this.maxEntities = 1000;\n\n    this.gameObjectCount = 0;\n\n    /**\n     * The list of active game objects to be updated each framr\n     */\n    this.gameObjects = [\n      new Enemy(),\n    ];\n  }\n\n  /**\n   * \n   * @param {integer} w The width of the canvas, in pixels. \n   * @param {integer} h The height of the canvas, in pixels.\n   */\n  genCanvas(w: number, h: number): HTMLCanvasElement {\n    let canvas = document.createElement('canvas');\n    canvas.id = \"game-pane\";\n    canvas.width = w;\n    canvas.height = h;\n\n    return canvas;\n  }\n\n  /**\n   * Calculates the game state as of a given point in time. It is the authority\n   * for game state. The delta should be used in calculations to make the game\n   * simulation framerate independent.\n   *\n   * @param {float} delta  The difference in time between this frame and last\n   * frame, in seconds.\n   */\n  update(delta: number): void {\n    for (let i=0; i<this.gameObjectCount; i++) {\n      this.gameObjects[i].update(delta);\n    }\n\n    this.gameObjectCount = this.gameObjects.length;\n  }\n\n  /**\n   * Stops the main game loop.\n   */\n  stopMainLoop(): void {\n    window.cancelAnimationFrame(this.stopToken);\n    console.log(\"Goodbye...\");\n  }\n\n  /**\n   * Attempts to gracefully tear down the game.\n   */\n  shutdownGame(): void {\n\n  }\n}\n","export class Renderer {\n\n  EMPTY_TILE: number;\n  ctx: CanvasRenderingContext2D;\n  pixels: number;\n  scale: number;\n\n  constructor(context) {\n    /**\n     * The empty tile value. If this value is set for a position in a map's \n     * array, it will not be rendered. \n     * \n     * @var {integer} \n     */\n    this.EMPTY_TILE = 0;\n\n    /**\n     * The canvas context.\n     * \n     * @var {CanvasRenderingContext2D}\n     */\n    this.ctx = context;\n\n    /**\n     * Multiplier for x,y position to pixels. What size the tiles for the game\n     * will be rendered at. Always use a power of 2 so the scaling prevents\n     * blurring.\n     * \n     * @var {integer}\n     */\n    this.pixels = 32;\n\n    /**\n     * The scale at which the tile will be rendered. 1 = 1x scaling, 2 = 2x \n     * scaling, etc.\n     * \n     * @var {integer}\n     */\n    this.scale = 1;\n  }\n\n  draw() {\n    // Clear the screen\n    window.FG.ctx.clearRect(\n      0, \n      0, \n      window.FG.canvas.width, \n      window.FG.canvas.height\n    );\n\n    this.drawTileMap(new Overworld());\n    \n    for (let i=0; i<window.FG.gameObjectCount; i++) {\n      window.FG.gameObjects[i].draw();\n    }\n  }\n\n  /**\n   * Renders a map according to the coordinates given in the map's file by\n   * translating the coordinates to a spritesheet. \n   * \n   * If a tile is 32x32 pixels, the 1st tile will start at (0,0) on \n   * the spritesheet, the 2nd tile will start at (32,0), the 34d at (64,0) and \n   * so on.\n   * \n   * +---+---+---+---+\n   * | 1 | 2 | 3 | 4 |\n   * +---+---+---+---+\n   * | 5 | 6 | 7 | 8 |\n   * +---+---+---+---+\n   * \n   * 'source x' and 'source y' will get the correct coords in the image file.\n   * So for our first tile, '1', drawImage will grab the subimage at (32,0).\n   * drawImage would get the subimage at (64,32) for tile '7'.\n   * \n   * TODO  https://hashrocket.com/blog/posts/using-tiled-and-canvas-to-render-game-screens\n   *\n   * @param {Object} map  The map object that extends MapBase.\n   */\n  drawTileMap(map): void {\n    for (let x=0; x<map.cols; x++) {\n      for (let y=0; y<map.rows; y++) {\n        let tile = map.getTile(x, y);\n\n        // Let's skip rendering empty tiles.\n        if (tile !== this.EMPTY_TILE) { \n          this.ctx.drawImage(\n            // Image Source\n            map.SM, \n            // Source x (See example in comment block)\n            ((tile - 1) % map.cols) * this.pixels, \n            // Source y (See example in comment block)\n            Math.floor(((tile - 1) / map.rows)) * this.pixels,  \n            // Source width\n            this.pixels, \n            // Source height\n            this.pixels, \n            // Target x\n            x * (this.pixels * this.scale), \n            // Target y\n            y * (this.pixels * this.scale),\n            // Target width \n            this.pixels * this.scale,\n             // Target height\n            this.pixels * this.scale,\n          );\n        }\n      }\n    }\n  }\n}\n","// import { FiendGame as FG } from \"../engine/FiendGame\";\n\nexport class Enemy {\n  public HP: number;\n  public ATK: number;\n  public speed: number;\n  public position: { x: number, y: number };\n\n  constructor() {\n    this.HP = 100;\n    this.ATK = 1;\n    this.speed = 100;\n    this.position = {\n      x: 0,\n      y: 0\n    };\n  }\n\n  update(delta: number) {\n    this.position.x += this.speed * delta;\n    this.position.y += this.speed * delta;\n  }\n\n  draw() {\n    window.FG.ctx.beginPath();\n    window.FG.ctx.arc(this.position.x, this.position.y, 10, 0, Math.PI*2);\n    window.FG.ctx.fillStyle = \"#0095DD\";\n    window.FG.ctx.fill();\n    window.FG.ctx.closePath();\n  }\n}\n","import { Enemy } from \"./entities/Enemy\";\nimport { FiendGame } from \"./engine/FiendGame\";\nimport { Renderer } from \"./engine/Renderer/Renderer\";\n\ndeclare global {\n  interface Window { \n    FG: FiendGame,\n    R: Renderer,\n  }\n}\n\n/**\n * Starting with the semicolon is in case whatever line of code above this\n * example relied on automatic semicolon insertion (ASI). The browser could\n * accidentally think this whole example continues from the previous line. The\n * leading semicolon marks the beginning of our new line if the previous one was\n * not empty or terminated.\n */\n function init() {\n\n  // init functionality, for now\n  window.FG = new FiendGame(640, 480);\n  window.R = new Renderer(window.FG.ctx);\n\n  main(performance.now());\n\n};\n\n/**\n * Ensure the assets are loaded before we initialize the game. We do this with a\n * promise to ensure all the images are loaded and ready to be used.\n */\n window.onload = function() {\n  var p = F_LOADER.initAssets();\n  Promise.all(p).then(function () {\n    init();\n  }.bind(this));\n}\n\n/**\n  * The main game loop. We use requestAnimationFrame to be thread-safe and not\n  * dominate the browser when the player blurs focus on our tab.\n  *\n  * render() is passed tFrame because it is assumed that the render method will\n  *          calculate how long it has been since the most recently passed\n  *          update tick for extrapolation (purely cosmetic for fast devices).\n  *          It draws the scene.\n  *\n  * update() calculates the game state as of a given point in time.\n  *\n  * init()   Performs whatever tasks are needed before the main loop can run.\n  *\n  *\n  * @param {DOMHighResTimeStamp} tFrame The number of milliseconds since\n  * navigationStart (when the previous document is unloaded.\n  * window.requestAnimationFrame() always provides a DOMHighResTimeStamp to\n  * callbacks as an argument when they are executed.\n  */\n  function main(tFrame) {\n  // Store the ID returned from our main loop's most recent call to\n  // requestAnimationFrame().\n  window.FG.stopToken = window.requestAnimationFrame(main);\n\n  // Delta should be in seconds, not ms, so we divide by 1000.\n  let delta = (tFrame - window.FG.lastFrameTime) / 1000.0;\n  // Keep track of when the last frame happened.\n  window.FG.lastFrameTime = tFrame;\n\n  // TODO processInput();\n  window.FG.update(delta);\n  window.R.draw();\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvZW5naW5lL0ZpZW5kR2FtZS50cyIsInNyYy9lbmdpbmUvUmVuZGVyZXIvUmVuZGVyZXIudHMiLCJzcmMvZW50aXRpZXMvRW5lbXkudHMiLCJzcmMvbWFpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7QUNFQTs7OztJQUlhLFMsV0FBQSxTO0FBY1gscUJBQVksYUFBWixFQUFtQyxjQUFuQyxFQUF5RDtBQUFBOztBQUV2RDs7O0FBR0EsU0FBSyxNQUFMLEdBQWMsS0FBSyxTQUFMLENBQWUsYUFBZixFQUE4QixjQUE5QixDQUFkO0FBQ0EsU0FBSyxTQUFMLEdBQWlCLFNBQVMsY0FBVCxDQUF3QixZQUF4QixDQUFqQjtBQUNBLFNBQUssU0FBTCxDQUFlLFlBQWYsQ0FBNEIsS0FBSyxNQUFqQyxFQUF5QyxLQUFLLFNBQUwsQ0FBZSxVQUF4RDtBQUNBLFNBQUssR0FBTCxHQUFXLEtBQUssTUFBTCxDQUFZLFVBQVosQ0FBdUIsSUFBdkIsQ0FBWDtBQUVBOzs7OztBQUtBLFNBQUssR0FBTCxDQUFTLHFCQUFULEdBQWlDLEtBQWpDO0FBRUE7Ozs7Ozs7QUFPQSxTQUFLLFNBQUwsR0FBaUIsSUFBakI7QUFFQTs7OztBQUlBLFNBQUssVUFBTCxHQUFrQixFQUFsQjtBQUVBOzs7O0FBSUEsU0FBSyxhQUFMLEdBQXFCLENBQXJCO0FBRUEsU0FBSyxXQUFMLEdBQW1CLElBQW5CO0FBRUEsU0FBSyxlQUFMLEdBQXVCLENBQXZCO0FBRUE7OztBQUdBLFNBQUssV0FBTCxHQUFtQixDQUNqQixJQUFJLFlBQUosRUFEaUIsQ0FBbkI7QUFHRDtBQUVEOzs7Ozs7Ozs7OEJBS1UsQyxFQUFXLEMsRUFBUztBQUM1QixVQUFJLFNBQVMsU0FBUyxhQUFULENBQXVCLFFBQXZCLENBQWI7QUFDQSxhQUFPLEVBQVAsR0FBWSxXQUFaO0FBQ0EsYUFBTyxLQUFQLEdBQWUsQ0FB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QUFTLE9BQU8sRUFBUCxDQUFVLGFBQXBCLElBQXFDLE1BQWpEO0FBQ0E7QUFDQSxXQUFPLEVBQVAsQ0FBVSxhQUFWLEdBQTBCLE1BQTFCO0FBRUE7QUFDQSxXQUFPLEVBQVAsQ0FBVSxNQUFWLENBQWlCLEtBQWpCO0FBQ0EsV0FBTyxDQUFQLENBQVMsSUFBVDtBQUNEIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiaW1wb3J0IHsgRW5lbXkgfSBmcm9tIFwiLi4vZW50aXRpZXMvRW5lbXlcIjtcblxuLyoqXG4gKiBUaGUgR2FtZSBzdXBlcmNsYXNzLiBPcGVyYXRpb25zIHRvIGFjdCB1cG9uIHRoZSBtYWluIGdhbWUgdGhyZWFkIGFyZSBmb3VuZFxuICogaGVyZS5cbiAqL1xuZXhwb3J0IGNsYXNzIEZpZW5kR2FtZSB7XG5cbiAgcHVibGljIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQ7XG4gIHB1YmxpYyBnYW1lT2JqZWN0Q291bnQ6IG51bWJlcjtcbiAgcHVibGljIGdhbWVPYmplY3RzOiBBcnJheTxFbmVteT47XG5cbiAgcHVibGljIGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xuICBcbiAgcHJvdGVjdGVkIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG4gIHN0b3BUb2tlbjogbnVtYmVyfG51bGw7XG4gIHRpY2tMZW5ndGg6IG51bWJlcjtcbiAgbGFzdEZyYW1lVGltZTogbnVtYmVyO1xuICBtYXhFbnRpdGllczogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKGdhbWVQYW5lV2lkdGg6IG51bWJlciwgZ2FtZVBhbmVIZWlnaHQ6IG51bWJlcikge1xuXG4gICAgLyoqXG4gICAgICogXG4gICAgICovXG4gICAgdGhpcy5jYW52YXMgPSB0aGlzLmdlbkNhbnZhcyhnYW1lUGFuZVdpZHRoLCBnYW1lUGFuZUhlaWdodCk7XG4gICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZpZW5kLWdhbWVcIik7XG4gICAgdGhpcy5jb250YWluZXIuaW5zZXJ0QmVmb3JlKHRoaXMuY2FudmFzLCB0aGlzLmNvbnRhaW5lci5maXJzdENoaWxkKTtcbiAgICB0aGlzLmN0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cbiAgICAvKip0XG4gICAgICogUHJldmVudCBhbnRpLWFsaWFzaW5nIGluIHRoZSBldmVudCBhIHRpbGUgZ2V0cyBzY2FsZWQuXG4gICAgICogXG4gICAgICogQHByb3BlcnR5IHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkfVxuICAgICAqL1xuICAgIHRoaXMuY3R4LmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogVGhlIElEIHJldHVybmVkIGZyb20gb3VyIG1haW4gbG9vcCdzIG1vc3QgcmVjZW50IGNhbGwgdG9cbiAgICAgKiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKS4gVGhlIHRva2VuIGNhbiB0aGVuIGJlIHVzZWQgd2hlbiB3ZSBjYWxsXG4gICAgICogY2FuY2VsQW5pbWF0aW9uRnJhbWUoKSB0byBzdG9wIHRoZSBtYWluIGxvb3AgYnkgdGVsbGluZyB0aGUgYnJvd3NlciB0b1xuICAgICAqIGNhbmNlbCB0aGUgcmVxdWVzdCB0aGF0IGNvcnJlc3BvbmRzIHRvIG91ciB0b2tlbi5cbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHRoaXMuc3RvcFRva2VuID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIEhvdyBmcmVxdWVudGx5IHRoZSBnYW1lIHN0YXRlIHVwZGF0ZXMuIEl0IGlzIDE2LjY2IEh6ICg2MG1zKVxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy50aWNrTGVuZ3RoID0gNjA7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgbW9zdCByZWNlbnRseSBlbGFwc2VkIHRpY2sgb2YgdGhlIGdhbWUgY2xvY2suXG4gICAgICogQHR5cGUge2RvdWJsZX0gRE9NSGlnaFJlc1RpbWVTdGFtcFxuICAgICAqL1xuICAgIHRoaXMubGFzdEZyYW1lVGltZSA9IDA7XG5cbiAgICB0aGlzLm1heEVudGl0aWVzID0gMTAwMDtcblxuICAgIHRoaXMuZ2FtZU9iamVjdENvdW50ID0gMDtcblxuICAgIC8qKlxuICAgICAqIFRoZSBsaXN0IG9mIGFjdGl2ZSBnYW1lIG9iamVjdHMgdG8gYmUgdXBkYXRlZCBlYWNoIGZyYW1yXG4gICAgICovXG4gICAgdGhpcy5nYW1lT2JqZWN0cyA9IFtcbiAgICAgIG5ldyBFbmVteSgpLFxuICAgIF07XG4gIH1cblxuICAvKipcbiAgICogXG4gICAqIEBwYXJhbSB7aW50ZWdlcn0gdyBUaGUgd2lkdGggb2YgdGhlIGNhbnZhcywgaW4gcGl4ZWxzLiBcbiAgICogQHBhcmFtIHtpbnRlZ2VyfSBoIFRoZSBoZWlnaHQgb2YgdGhlIGNhbnZhcywgaW4gcGl4ZWxzLlxuICAgKi9cbiAgZ2VuQ2FudmFzKHc6IG51bWJlciwgaDogbnVtYmVyKTogSFRNTENhbnZhc0VsZW1lbnQge1xuICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICBjYW52YXMuaWQgPSBcImdhbWUtcGFuZVwiO1xuICAgIGNhbnZhcy53aWR0aCA9IHc7XG4gICAgY2FudmFzLmhlaWdodCA9IGg7XG5cbiAgICByZXR1cm4gY2FudmFzO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIGdhbWUgc3RhdGUgYXMgb2YgYSBnaXZlbiBwb2ludCBpbiB0aW1lLiBJdCBpcyB0aGUgYXV0aG9yaXR5XG4gICAqIGZvciBnYW1lIHN0YXRlLiBUaGUgZGVsdGEgc2hvdWxkIGJlIHVzZWQgaW4gY2FsY3VsYXRpb25zIHRvIG1ha2UgdGhlIGdhbWVcbiAgICogc2ltdWxhdGlvbiBmcmFtZXJhdGUgaW5kZXBlbmRlbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7ZmxvYXR9IGRlbHRhICBUaGUgZGlmZmVyZW5jZSBpbiB0aW1lIGJldHdlZW4gdGhpcyBmcmFtZSBhbmQgbGFzdFxuICAgKiBmcmFtZSwgaW4gc2Vjb25kcy5cbiAgICovXG4gIHVwZGF0ZShkZWx0YTogbnVtYmVyKTogdm9pZCB7XG4gICAgZm9yIChsZXQgaT0wOyBpPHRoaXMuZ2FtZU9iamVjdENvdW50OyBpKyspIHtcbiAgICAgIHRoaXMuZ2FtZU9iamVjdHNbaV0udXBkYXRlKGRlbHRhKTtcbiAgICB9XG5cbiAgICB0aGlzLmdhbWVPYmplY3RDb3VudCA9IHRoaXMuZ2FtZU9iamVjdHMubGVuZ3RoO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3BzIHRoZSBtYWluIGdhbWUgbG9vcC5cbiAgICovXG4gIHN0b3BNYWluTG9vcCgpOiB2b2lkIHtcbiAgICB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5zdG9wVG9rZW4pO1xuICAgIGNvbnNvbGUubG9nKFwiR29vZGJ5ZS4uLlwiKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdHRlbXB0cyB0byBncmFjZWZ1bGx5IHRlYXIgZG93biB0aGUgZ2FtZS5cbiAgICovXG4gIHNodXRkb3duR2FtZSgpOiB2b2lkIHtcblxuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgUmVuZGVyZXIge1xuXG4gIEVNUFRZX1RJTEU6IG51bWJlcjtcbiAgY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XG4gIHBpeGVsczogbnVtYmVyO1xuICBzY2FsZTogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKGNvbnRleHQpIHtcbiAgICAvKipcbiAgICAgKiBUaGUgZW1wdHkgdGlsZSB2YWx1ZS4gSWYgdGhpcyB2YWx1ZSBpcyBzZXQgZm9yIGEgcG9zaXRpb24gaW4gYSBtYXAncyBcbiAgICAgKiBhcnJheSwgaXQgd2lsbCBub3QgYmUgcmVuZGVyZWQuIFxuICAgICAqIFxuICAgICAqIEB2YXIge2ludGVnZXJ9IFxuICAgICAqL1xuICAgIHRoaXMuRU1QVFlfVElMRSA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY2FudmFzIGNvbnRleHQuXG4gICAgICogXG4gICAgICogQHZhciB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfVxuICAgICAqL1xuICAgIHRoaXMuY3R4ID0gY29udGV4dDtcblxuICAgIC8qKlxuICAgICAqIE11bHRpcGxpZXIgZm9yIHgseSBwb3NpdGlvbiB0byBwaXhlbHMuIFdoYXQgc2l6ZSB0aGUgdGlsZXMgZm9yIHRoZSBnYW1lXG4gICAgICogd2lsbCBiZSByZW5kZXJlZCBhdC4gQWx3YXlzIHVzZSBhIHBvd2VyIG9mIDIgc28gdGhlIHNjYWxpbmcgcHJldmVudHNcbiAgICAgKiBibHVycmluZy5cbiAgICAgKiBcbiAgICAgKiBAdmFyIHtpbnRlZ2VyfVxuICAgICAqL1xuICAgIHRoaXMucGl4ZWxzID0gMzI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgc2NhbGUgYXQgd2hpY2ggdGhlIHRpbGUgd2lsbCBiZSByZW5kZXJlZC4gMSA9IDF4IHNjYWxpbmcsIDIgPSAyeCBcbiAgICAgKiBzY2FsaW5nLCBldGMuXG4gICAgICogXG4gICAgICogQHZhciB7aW50ZWdlcn1cbiAgICAgKi9cbiAgICB0aGlzLnNjYWxlID0gMTtcbiAgfVxuXG4gIGRyYXcoKSB7XG4gICAgLy8gQ2xlYXIgdGhlIHNjcmVlblxuICAgIHdpbmRvdy5GRy5jdHguY2xlYXJSZWN0KFxuICAgICAgMCwgXG4gICAgICAwLCBcbiAgICAgIHdpbmRvdy5GRy5jYW52YXMud2lkdGgsIFxuICAgICAgd2luZG93LkZHLmNhbnZhcy5oZWlnaHRcbiAgICApO1xuXG4gICAgdGhpcy5kcmF3VGlsZU1hcChuZXcgT3ZlcndvcmxkKCkpO1xuICAgIFxuICAgIGZvciAobGV0IGk9MDsgaTx3aW5kb3cuRkcuZ2FtZU9iamVjdENvdW50OyBpKyspIHtcbiAgICAgIHdpbmRvdy5GRy5nYW1lT2JqZWN0c1tpXS5kcmF3KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgYSBtYXAgYWNjb3JkaW5nIHRvIHRoZSBjb29yZGluYXRlcyBnaXZlbiBpbiB0aGUgbWFwJ3MgZmlsZSBieVxuICAgKiB0cmFuc2xhdGluZyB0aGUgY29vcmRpbmF0ZXMgdG8gYSBzcHJpdGVzaGVldC4gXG4gICAqIFxuICAgKiBJZiBhIHRpbGUgaXMgMzJ4MzIgcGl4ZWxzLCB0aGUgMXN0IHRpbGUgd2lsbCBzdGFydCBhdCAoMCwwKSBvbiBcbiAgICogdGhlIHNwcml0ZXNoZWV0LCB0aGUgMm5kIHRpbGUgd2lsbCBzdGFydCBhdCAoMzIsMCksIHRoZSAzNGQgYXQgKDY0LDApIGFuZCBcbiAgICogc28gb24uXG4gICAqIFxuICAgKiArLS0tKy0tLSstLS0rLS0tK1xuICAgKiB8IDEgfCAyIHwgMyB8IDQgfFxuICAgKiArLS0tKy0tLSstLS0rLS0tK1xuICAgKiB8IDUgfCA2IHwgNyB8IDggfFxuICAgKiArLS0tKy0tLSstLS0rLS0tK1xuICAgKiBcbiAgICogJ3NvdXJjZSB4JyBhbmQgJ3NvdXJjZSB5JyB3aWxsIGdldCB0aGUgY29ycmVjdCBjb29yZHMgaW4gdGhlIGltYWdlIGZpbGUuXG4gICAqIFNvIGZvciBvdXIgZmlyc3QgdGlsZSwgJzEnLCBkcmF3SW1hZ2Ugd2lsbCBncmFiIHRoZSBzdWJpbWFnZSBhdCAoMzIsMCkuXG4gICAqIGRyYXdJbWFnZSB3b3VsZCBnZXQgdGhlIHN1YmltYWdlIGF0ICg2NCwzMikgZm9yIHRpbGUgJzcnLlxuICAgKiBcbiAgICogVE9ETyAgaHR0cHM6Ly9oYXNocm9ja2V0LmNvbS9ibG9nL3Bvc3RzL3VzaW5nLXRpbGVkLWFuZC1jYW52YXMtdG8tcmVuZGVyLWdhbWUtc2NyZWVuc1xuICAgKlxuICAgKiBAcGFyYW0ge09iamVjdH0gbWFwICBUaGUgbWFwIG9iamVjdCB0aGF0IGV4dGVuZHMgTWFwQmFzZS5cbiAgICovXG4gIGRyYXdUaWxlTWFwKG1hcCk6IHZvaWQge1xuICAgIGZvciAobGV0IHg9MDsgeDxtYXAuY29sczsgeCsrKSB7XG4gICAgICBmb3IgKGxldCB5PTA7IHk8bWFwLnJvd3M7IHkrKykge1xuICAgICAgICBsZXQgdGlsZSA9IG1hcC5nZXRUaWxlKHgsIHkpO1xuXG4gICAgICAgIC8vIExldCdzIHNraXAgcmVuZGVyaW5nIGVtcHR5IHRpbGVzLlxuICAgICAgICBpZiAodGlsZSAhPT0gdGhpcy5FTVBUWV9USUxFKSB7IFxuICAgICAgICAgIHRoaXMuY3R4LmRyYXdJbWFnZShcbiAgICAgICAgICAgIC8vIEltYWdlIFNvdXJjZVxuICAgICAgICAgICAgbWFwLlNNLCBcbiAgICAgICAgICAgIC8vIFNvdXJjZSB4IChTZWUgZXhhbXBsZSBpbiBjb21tZW50IGJsb2NrKVxuICAgICAgICAgICAgKCh0aWxlIC0gMSkgJSBtYXAuY29scykgKiB0aGlzLnBpeGVscywgXG4gICAgICAgICAgICAvLyBTb3VyY2UgeSAoU2VlIGV4YW1wbGUgaW4gY29tbWVudCBibG9jaylcbiAgICAgICAgICAgIE1hdGguZmxvb3IoKCh0aWxlIC0gMSkgLyBtYXAucm93cykpICogdGhpcy5waXhlbHMsICBcbiAgICAgICAgICAgIC8vIFNvdXJjZSB3aWR0aFxuICAgICAgICAgICAgdGhpcy5waXhlbHMsIFxuICAgICAgICAgICAgLy8gU291cmNlIGhlaWdodFxuICAgICAgICAgICAgdGhpcy5waXhlbHMsIFxuICAgICAgICAgICAgLy8gVGFyZ2V0IHhcbiAgICAgICAgICAgIHggKiAodGhpcy5waXhlbHMgKiB0aGlzLnNjYWxlKSwgXG4gICAgICAgICAgICAvLyBUYXJnZXQgeVxuICAgICAgICAgICAgeSAqICh0aGlzLnBpeGVscyAqIHRoaXMuc2NhbGUpLFxuICAgICAgICAgICAgLy8gVGFyZ2V0IHdpZHRoIFxuICAgICAgICAgICAgdGhpcy5waXhlbHMgKiB0aGlzLnNjYWxlLFxuICAgICAgICAgICAgIC8vIFRhcmdldCBoZWlnaHRcbiAgICAgICAgICAgIHRoaXMucGl4ZWxzICogdGhpcy5zY2FsZSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iLCIvLyBpbXBvcnQgeyBGaWVuZEdhbWUgYXMgRkcgfSBmcm9tIFwiLi4vZW5naW5lL0ZpZW5kR2FtZVwiO1xuXG5leHBvcnQgY2xhc3MgRW5lbXkge1xuICBwdWJsaWMgSFA6IG51bWJlcjtcbiAgcHVibGljIEFUSzogbnVtYmVyO1xuICBwdWJsaWMgc3BlZWQ6IG51bWJlcjtcbiAgcHVibGljIHBvc2l0aW9uOiB7IHg6IG51bWJlciwgeTogbnVtYmVyIH07XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5IUCA9IDEwMDtcbiAgICB0aGlzLkFUSyA9IDE7XG4gICAgdGhpcy5zcGVlZCA9IDEwMDtcbiAgICB0aGlzLnBvc2l0aW9uID0ge1xuICAgICAgeDogMCxcbiAgICAgIHk6IDBcbiAgICB9O1xuICB9XG5cbiAgdXBkYXRlKGRlbHRhOiBudW1iZXIpIHtcbiAgICB0aGlzLnBvc2l0aW9uLnggKz0gdGhpcy5zcGVlZCAqIGRlbHRhO1xuICAgIHRoaXMucG9zaXRpb24ueSArPSB0aGlzLnNwZWVkICogZGVsdGE7XG4gIH1cblxuICBkcmF3KCkge1xuICAgIHdpbmRvdy5GRy5jdHguYmVnaW5QYXRoKCk7XG4gICAgd2luZG93LkZHLmN0eC5hcmModGhpcy5wb3NpdGlvbi54LCB0aGlzLnBvc2l0aW9uLnksIDEwLCAwLCBNYXRoLlBJKjIpO1xuICAgIHdpbmRvdy5GRy5jdHguZmlsbFN0eWxlID0gXCIjMDA5NUREXCI7XG4gICAgd2luZG93LkZHLmN0eC5maWxsKCk7XG4gICAgd2luZG93LkZHLmN0eC5jbG9zZVBhdGgoKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgRW5lbXkgfSBmcm9tIFwiLi9lbnRpdGllcy9FbmVteVwiO1xuaW1wb3J0IHsgRmllbmRHYW1lIH0gZnJvbSBcIi4vZW5naW5lL0ZpZW5kR2FtZVwiO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tIFwiLi9lbmdpbmUvUmVuZGVyZXIvUmVuZGVyZXJcIjtcblxuZGVjbGFyZSBnbG9iYWwge1xuICBpbnRlcmZhY2UgV2luZG93IHsgXG4gICAgRkc6IEZpZW5kR2FtZSxcbiAgICBSOiBSZW5kZXJlcixcbiAgfVxufVxuXG4vKipcbiAqIFN0YXJ0aW5nIHdpdGggdGhlIHNlbWljb2xvbiBpcyBpbiBjYXNlIHdoYXRldmVyIGxpbmUgb2YgY29kZSBhYm92ZSB0aGlzXG4gKiBleGFtcGxlIHJlbGllZCBvbiBhdXRvbWF0aWMgc2VtaWNvbG9uIGluc2VydGlvbiAoQVNJKS4gVGhlIGJyb3dzZXIgY291bGRcbiAqIGFjY2lkZW50YWxseSB0aGluayB0aGlzIHdob2xlIGV4YW1wbGUgY29udGludWVzIGZyb20gdGhlIHByZXZpb3VzIGxpbmUuIFRoZVxuICogbGVhZGluZyBzZW1pY29sb24gbWFya3MgdGhlIGJlZ2lubmluZyBvZiBvdXIgbmV3IGxpbmUgaWYgdGhlIHByZXZpb3VzIG9uZSB3YXNcbiAqIG5vdCBlbXB0eSBvciB0ZXJtaW5hdGVkLlxuICovXG4gZnVuY3Rpb24gaW5pdCgpIHtcblxuICAvLyBpbml0IGZ1bmN0aW9uYWxpdHksIGZvciBub3dcbiAgd2luZG93LkZHID0gbmV3IEZpZW5kR2FtZSg2NDAsIDQ4MCk7XG4gIHdpbmRvdy5SID0gbmV3IFJlbmRlcmVyKHdpbmRvdy5GRy5jdHgpO1xuXG4gIG1haW4ocGVyZm9ybWFuY2Uubm93KCkpO1xuXG59O1xuXG4vKipcbiAqIEVuc3VyZSB0aGUgYXNzZXRzIGFyZSBsb2FkZWQgYmVmb3JlIHdlIGluaXRpYWxpemUgdGhlIGdhbWUuIFdlIGRvIHRoaXMgd2l0aCBhXG4gKiBwcm9taXNlIHRvIGVuc3VyZSBhbGwgdGhlIGltYWdlcyBhcmUgbG9hZGVkIGFuZCByZWFkeSB0byBiZSB1c2VkLlxuICovXG4gd2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgcCA9IEZfTE9BREVSLmluaXRBc3NldHMoKTtcbiAgUHJvbWlzZS5hbGwocCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgaW5pdCgpO1xuICB9LmJpbmQodGhpcykpO1xufVxuXG4vKipcbiAgKiBUaGUgbWFpbiBnYW1lIGxvb3AuIFdlIHVzZSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgdG8gYmUgdGhyZWFkLXNhZmUgYW5kIG5vdFxuICAqIGRvbWluYXRlIHRoZSBicm93c2VyIHdoZW4gdGhlIHBsYXllciBibHVycyBmb2N1cyBvbiBvdXIgdGFiLlxuICAqXG4gICogcmVuZGVyKCkgaXMgcGFzc2VkIHRGcmFtZSBiZWNhdXNlIGl0IGlzIGFzc3VtZWQgdGhhdCB0aGUgcmVuZGVyIG1ldGhvZCB3aWxsXG4gICogICAgICAgICAgY2FsY3VsYXRlIGhvdyBsb25nIGl0IGhhcyBiZWVuIHNpbmNlIHRoZSBtb3N0IHJlY2VudGx5IHBhc3NlZFxuICAqICAgICAgICAgIHVwZGF0ZSB0aWNrIGZvciBleHRyYXBvbGF0aW9uIChwdXJlbHkgY29zbWV0aWMgZm9yIGZhc3QgZGV2aWNlcykuXG4gICogICAgICAgICAgSXQgZHJhd3MgdGhlIHNjZW5lLlxuICAqXG4gICogdXBkYXRlKCkgY2FsY3VsYXRlcyB0aGUgZ2FtZSBzdGF0ZSBhcyBvZiBhIGdpdmVuIHBvaW50IGluIHRpbWUuXG4gICpcbiAgKiBpbml0KCkgICBQZXJmb3JtcyB3aGF0ZXZlciB0YXNrcyBhcmUgbmVlZGVkIGJlZm9yZSB0aGUgbWFpbiBsb29wIGNhbiBydW4uXG4gICpcbiAgKlxuICAqIEBwYXJhbSB7RE9NSGlnaFJlc1RpbWVTdGFtcH0gdEZyYW1lIFRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHNpbmNlXG4gICogbmF2aWdhdGlvblN0YXJ0ICh3aGVuIHRoZSBwcmV2aW91cyBkb2N1bWVudCBpcyB1bmxvYWRlZC5cbiAgKiB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCkgYWx3YXlzIHByb3ZpZGVzIGEgRE9NSGlnaFJlc1RpbWVTdGFtcCB0b1xuICAqIGNhbGxiYWNrcyBhcyBhbiBhcmd1bWVudCB3aGVuIHRoZXkgYXJlIGV4ZWN1dGVkLlxuICAqL1xuICBmdW5jdGlvbiBtYWluKHRGcmFtZSkge1xuICAvLyBTdG9yZSB0aGUgSUQgcmV0dXJuZWQgZnJvbSBvdXIgbWFpbiBsb29wJ3MgbW9zdCByZWNlbnQgY2FsbCB0b1xuICAvLyByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKS5cbiAgd2luZG93LkZHLnN0b3BUb2tlbiA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobWFpbik7XG5cbiAgLy8gRGVsdGEgc2hvdWxkIGJlIGluIHNlY29uZHMsIG5vdCBtcywgc28gd2UgZGl2aWRlIGJ5IDEwMDAuXG4gIGxldCBkZWx0YSA9ICh0RnJhbWUgLSB3aW5kb3cuRkcubGFzdEZyYW1lVGltZSkgLyAxMDAwLjA7XG4gIC8vIEtlZXAgdHJhY2sgb2Ygd2hlbiB0aGUgbGFzdCBmcmFtZSBoYXBwZW5lZC5cbiAgd2luZG93LkZHLmxhc3RGcmFtZVRpbWUgPSB0RnJhbWU7XG5cbiAgLy8gVE9ETyBwcm9jZXNzSW5wdXQoKTtcbiAgd2luZG93LkZHLnVwZGF0ZShkZWx0YSk7XG4gIHdpbmRvdy5SLmRyYXcoKTtcbn0iXX0="}